javascript:(function()%7Bjavascript%3A(function()%7B%0A%20%20const%20folder%20%3D%20%22Clippings%2F%22%3B%20%0A%20%20const%20vault%20%3D%20%22%22%3B%20%0A%20%20const%20baseTags%20%3D%20%22clippings%2C%20blinkist%22%3B%20%0A%0A%20%20function%20getBookId()%20%7B%0A%20%20%20%20var%20match%20%3D%20document.body.innerHTML.match(%2F%22id%22%3A%22(%5B0-9a-f%5D%7B24%7D)%22%2F)%3B%0A%20%20%20%20if(match)%20return%20match%5B1%5D%3B%0A%20%20%20%20var%20el%20%3D%20document.querySelector('%5Bdata-book-id%5D')%3B%0A%20%20%20%20if(el)%20return%20el.getAttribute('data-book-id')%3B%0A%20%20%20%20var%20regex%20%3D%20%2F%5B0-9a-f%5D%7B24%7D%2Fg%3B%0A%20%20%20%20var%20potential%20%3D%20document.body.innerHTML.match(regex)%3B%0A%20%20%20%20if(potential%20%26%26%20potential.length%20%3E%200)%20return%20potential%5B0%5D%3B%0A%20%20%20%20return%20null%3B%0A%20%20%7D%0A%0A%20%20function%20htmlToMarkdown(html)%20%7B%0A%20%20%20%20if%20(!html)%20return%20%22%22%3B%0A%20%20%20%20var%20text%20%3D%20html%3B%0A%20%20%20%20text%20%3D%20text.replace(%2F%3Cstrong%3E(.*%3F)%3C%5C%2Fstrong%3E%2Fgi%2C%20'**%241**')%3B%0A%20%20%20%20text%20%3D%20text.replace(%2F%3Cb%3E(.*%3F)%3C%5C%2Fb%3E%2Fgi%2C%20'**%241**')%3B%0A%20%20%20%20text%20%3D%20text.replace(%2F%3Cem%3E(.*%3F)%3C%5C%2Fem%3E%2Fgi%2C%20'*%241*')%3B%0A%20%20%20%20text%20%3D%20text.replace(%2F%3Ci%3E(.*%3F)%3C%5C%2Fi%3E%2Fgi%2C%20'*%241*')%3B%0A%20%20%20%20text%20%3D%20text.replace(%2F%3Cul%3E%2Fgi%2C%20'')%3B%0A%20%20%20%20text%20%3D%20text.replace(%2F%3C%5C%2Ful%3E%2Fgi%2C%20'')%3B%0A%20%20%20%20text%20%3D%20text.replace(%2F%3Cli%3E%2Fgi%2C%20'%5Cn-%20')%3B%0A%20%20%20%20text%20%3D%20text.replace(%2F%3C%5C%2Fli%3E%2Fgi%2C%20'')%3B%0A%20%20%20%20text%20%3D%20text.replace(%2F%3Cbr%5Cs*%5C%2F%3F%3E%2Fgi%2C%20'%5Cn')%3B%0A%20%20%20%20text%20%3D%20text.replace(%2F%3Cp%3E%2Fgi%2C%20'')%3B%0A%20%20%20%20text%20%3D%20text.replace(%2F%3C%5C%2Fp%3E%2Fgi%2C%20'%5Cn%5Cn')%3B%0A%20%20%20%20text%20%3D%20text.replace(%2F%3Ch%5B1-6%5D%3E(.*%3F)%3C%5C%2Fh%5B1-6%5D%3E%2Fgi%2C%20'%5Cn%23%23%20%241%5Cn')%3B%0A%20%20%20%20text%20%3D%20text.replace(%2F%3C%5B%5E%3E%5D%2B%3E%2Fg%2C%20'')%3B%0A%20%20%20%20var%20ta%20%3D%20document.createElement('textarea')%3B%0A%20%20%20%20ta.innerHTML%20%3D%20text%3B%0A%20%20%20%20return%20ta.value.trim()%3B%0A%20%20%7D%0A%0A%20%20function%20getMeta(name)%20%7B%0A%20%20%20%20const%20meta%20%3D%20document.querySelector(%60meta%5Bname%3D%22%24%7Bname%7D%22%5D%2C%20meta%5Bproperty%3D%22%24%7Bname%7D%22%5D%60)%3B%0A%20%20%20%20return%20meta%20%3F%20meta.getAttribute('content')%20%3A%20''%3B%0A%20%20%7D%0A%0A%20%20function%20getFileName(fileName)%20%7B%0A%20%20%20%20var%20platform%20%3D%20window.navigator.platform%3B%0A%20%20%20%20var%20windowsPlatforms%20%3D%20%5B'Win32'%2C%20'Win64'%2C%20'Windows'%2C%20'WinCE'%5D%3B%0A%20%20%20%20if%20(windowsPlatforms.indexOf(platform)%20!%3D%3D%20-1)%20%7B%0A%20%20%20%20%20%20fileName%20%3D%20fileName.replace('%3A'%2C%20'').replace(%2F%5B%2F%5C%5C%3F%25*%7C%22%3C%3E%5D%2Fg%2C%20'-')%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20fileName%20%3D%20fileName.replace('%3A'%2C%20'').replace(%2F%5C%2F%2Fg%2C%20'-').replace(%2F%5C%5C%2Fg%2C%20'-')%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20fileName%3B%0A%20%20%7D%0A%0A%20%20async%20function%20run()%20%7B%0A%20%20%20%20var%20id%20%3D%20getBookId()%3B%0A%20%20%20%20if(!id)%20%7B%20alert(%22Could%20not%20find%20Book%20ID%20on%20this%20page.%22)%3B%20return%3B%20%7D%0A%20%20%20%20%0A%20%20%20%20var%20lang%20%3D%20window.location.pathname.split('%2F')%5B1%5D%20%7C%7C%20'en'%3B%0A%20%20%20%20var%20apiUrl%20%3D%20'https%3A%2F%2Fapi.blinkist.com%2Ftranscripts%2F'%20%2B%20id%20%2B%20'%3Flanguage%3D'%20%2B%20lang%3B%0A%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20var%20response%20%3D%20await%20fetch(apiUrl)%3B%0A%20%20%20%20%20%20if(!response.ok)%20throw%20new%20Error(%22API%20Request%20failed%3A%20%22%20%2B%20response.status)%3B%0A%20%20%20%20%20%20var%20data%20%3D%20await%20response.json()%3B%0A%0A%20%20%20%20%20%20var%20rawTitle%20%3D%20document.title.replace('%20%7C%20Blinkist'%2C%20'').replace('%20-%20Blinkist'%2C%20'').trim()%3B%0A%20%20%20%20%20%20var%20finalTitle%20%3D%20rawTitle%3B%0A%20%20%20%20%20%20var%20finalAuthor%20%3D%20getMeta('author')%20%7C%7C%20%22Unknown%22%3B%0A%20%20%20%20%20%20var%20splitIndex%20%3D%20rawTitle.lastIndexOf(%22%20by%20%22)%3B%0A%20%20%20%20%20%20%0A%20%20%20%20%20%20if%20(splitIndex%20!%3D%3D%20-1)%20%7B%0A%20%20%20%20%20%20%20%20finalTitle%20%3D%20rawTitle.substring(0%2C%20splitIndex).trim()%3B%0A%20%20%20%20%20%20%20%20finalAuthor%20%3D%20rawTitle.substring(splitIndex%20%2B%204).trim()%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20var%20url%20%3D%20window.location.href%3B%0A%20%20%20%20%20%20var%20dateObj%20%3D%20new%20Date()%3B%0A%20%20%20%20%20%20var%20yyyy%20%3D%20dateObj.getFullYear()%3B%0A%20%20%20%20%20%20var%20mm%20%3D%20String(dateObj.getMonth()%20%2B%201).padStart(2%2C%20'0')%3B%0A%20%20%20%20%20%20var%20dd%20%3D%20String(dateObj.getDate()).padStart(2%2C%20'0')%3B%0A%20%20%20%20%20%20var%20today%20%3D%20%60%24%7Byyyy%7D-%24%7Bmm%7D-%24%7Bdd%7D%60%3B%0A%0A%20%20%20%20%20%20var%20mdBody%20%3D%20%22%22%3B%0A%20%20%20%20%20%20if%20(data.transcript%20%26%26%20data.transcript.transcriptSections)%20%7B%0A%20%20%20%20%20%20%20%20data.transcript.transcriptSections.forEach(function(section)%20%7B%0A%20%20%20%20%20%20%20%20%20%20if%20(section.transcriptComponents)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20section.transcriptComponents.forEach(function(component)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(component.value%20%26%26%20component.value.html)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20clean%20%3D%20htmlToMarkdown(component.value.html)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(component.componentType%20%3D%3D%3D%20'header')%20mdBody%20%2B%3D%20'%23%23%20'%20%2B%20clean%20%2B%20'%5Cn%5Cn'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20mdBody%20%2B%3D%20clean%20%2B%20'%5Cn%5Cn'%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20mdBody%20%3D%20%22No%20transcript%20data%20found.%22%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20mdBody%20%3D%20mdBody.replace(%2F%5Cn%7B3%2C%7D%2Fg%2C%20%22%5Cn%5Cn%22)%3B%0A%0A%20%20%20%20%20%20var%20fileName%20%3D%20getFileName(finalTitle)%3B%0A%20%20%20%20%20%20var%20vaultParam%20%3D%20vault%20%3F%20%60%26vault%3D%24%7BencodeURIComponent(vault)%7D%60%20%3A%20''%3B%0A%20%20%20%20%20%20var%20authorLink%20%3D%20finalAuthor%20!%3D%3D%20%22Unknown%22%20%3F%20%60%5B%5B%24%7BfinalAuthor%7D%5D%5D%60%20%3A%20%22Unknown%22%3B%0A%0A%20%20%20%20%20%20var%20fileContent%20%3D%20%0A%20%20%20%20%20%20%20%20'---%5Cn'%20%2B%0A%20%20%20%20%20%20%20%20'category%3A%20%22%5B%5BClippings%5D%5D%22%5Cn'%20%2B%0A%20%20%20%20%20%20%20%20'author%3A%20%22'%20%2B%20authorLink%20%2B%20'%22%5Cn'%20%2B%0A%20%20%20%20%20%20%20%20'title%3A%20%22'%20%2B%20finalTitle%20%2B%20'%22%5Cn'%20%2B%0A%20%20%20%20%20%20%20%20'source%3A%20'%20%2B%20url%20%2B%20'%5Cn'%20%2B%0A%20%20%20%20%20%20%20%20'clipped%3A%20'%20%2B%20today%20%2B%20'%5Cn'%20%2B%0A%20%20%20%20%20%20%20%20'tags%3A%20%5B'%20%2B%20baseTags%20%2B%20'%5D%5Cn'%20%2B%0A%20%20%20%20%20%20%20%20'---%5Cn%5Cn'%20%2B%0A%20%20%20%20%20%20%20%20'%23%20'%20%2B%20finalTitle%20%2B%20'%5Cn%5Cn'%20%2B%0A%20%20%20%20%20%20%20%20mdBody%3B%0A%0A%20%20%20%20%20%20var%20obsUrl%20%3D%20%22obsidian%3A%2F%2Fnew%3F%22%20%2B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22file%3D%22%20%2B%20encodeURIComponent(folder%20%2B%20fileName)%20%2B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%26content%3D%22%20%2B%20encodeURIComponent(fileContent)%20%2B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20vaultParam%3B%0A%0A%20%20%20%20%20%20document.location.href%20%3D%20obsUrl%3B%0A%0A%20%20%20%20%7D%20catch%20(e)%20%7B%0A%20%20%20%20%20%20alert(%22Error%3A%20%22%20%2B%20e.message)%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20run()%3B%0A%7D)()%3B%7D)()%3B
